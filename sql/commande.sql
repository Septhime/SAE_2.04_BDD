DROP TABLE IF EXISTS import;

CREATE temp TABLE temp_import (
n1 text, n2 text, n3 text, n4 text, n5 text, n6 text, n7 text, n8 text, n9 text, n10 text, n11 text,
n12 text, n13 text, n14 text, n15 text, n16 text, n17 text, n18 text, n19 text, n20 text, n21 text,
n22 text, n23 text, n24 text, n25 text, n26 text, n27 text, n28 text,
n29 text, n30 text, n31 text, n32 text, n33 text, n34 text, n35 text,
n36 text, n37 text, n38 text, n39 text, n40 text, n41 text, n42 text,
n43 text, n44 text, n45 text, n46 text, n47 text, n48 text, n49 text,
n50 text, n51 text, n52 text, n53 text, n54 text, n55 text, n56 text,
n57 text, n58 text, n59 text, n60 text, n61 text, n62 text, n63 text,
n64 text, n65 text, n66 text, n67 text, n68 text, n69 text, n70 text,
n71 text, n72 text, n73 text, n74 text, n75 text, n76 text, n77 text,
n78 text, n79 text, n80 text, n81 text, n82 text, n83 text, n84 text,
n85 text, n86 text, n87 text, n88 text, n89 text, n90 text, n91 text,
n92 text, n93 text, n94 text, n95 text, n96 text, n97 text, n98 text,
n99 text, n100 text, n101 text, n102 text, n103 text, n104 text, n105 text,
n106 text, n107 text, n108 text, n109 text, n110 text, n111 text, n112 text,
n113 text, n114 text, n115 text, n116 text, n117 text, n118 text);

CREATE TABLE import (
n1 INT DEFAULT NULL, n2 TEXT DEFAULT NULL, n3 CHAR(8) DEFAULT NULL, n4 TEXT DEFAULT NULL, n5 TEXT DEFAULT NULL, n6 TEXT DEFAULT NULL, n7 TEXT DEFAULT NULL, n8 TEXT DEFAULT NULL, n9 TEXT DEFAULT NULL, n10 TEXT DEFAULT NULL, n11 TEXT DEFAULT NULL,
n12 TEXT DEFAULT NULL, n13 TEXT DEFAULT NULL, n14 TEXT DEFAULT NULL, n15 TEXT DEFAULT NULL, n16 TEXT DEFAULT NULL, n17 TEXT DEFAULT NULL, n18 INT DEFAULT NULL, n19 INT DEFAULT NULL, n20 INT DEFAULT NULL, n21 INT DEFAULT NULL,
n22 INT DEFAULT NULL, n23 INT DEFAULT NULL, n24 INT DEFAULT NULL, n25 INT DEFAULT NULL, n26 INT DEFAULT NULL, n27 INT DEFAULT NULL, n28 INT DEFAULT NULL,
n29 INT DEFAULT NULL, n30 INT DEFAULT NULL, n31 INT DEFAULT NULL, n32 INT DEFAULT NULL, n33 INT DEFAULT NULL, n34 INT DEFAULT NULL, n35 INT DEFAULT NULL,
n36 INT DEFAULT NULL, n37 INT DEFAULT NULL, n38 INT DEFAULT NULL, n39 INT DEFAULT NULL, n40 INT DEFAULT NULL, n41 INT DEFAULT NULL, n42 INT DEFAULT NULL,
n43 INT DEFAULT NULL, n44 INT DEFAULT NULL, n45 INT DEFAULT NULL, n46 INT DEFAULT NULL, n47 INT DEFAULT NULL, n48 INT DEFAULT NULL, n49 INT DEFAULT NULL,
n50 INT DEFAULT NULL, n51 INT DEFAULT NULL, n52 INT DEFAULT NULL, n53 INT DEFAULT NULL, n54 INT DEFAULT NULL, n55 INT DEFAULT NULL, n56 INT DEFAULT NULL,
n57 INT DEFAULT NULL, n58 INT DEFAULT NULL, n59 INT DEFAULT NULL, n60 INT DEFAULT NULL, n61 INT DEFAULT NULL, n62 INT DEFAULT NULL, n63 INT DEFAULT NULL,
n64 INT DEFAULT NULL, n65 INT DEFAULT NULL, n66 INT DEFAULT NULL, n67 INT DEFAULT NULL, n68 INT DEFAULT NULL, n69 INT DEFAULT NULL, n70 INT DEFAULT NULL,
n71 INT DEFAULT NULL, n72 INT DEFAULT NULL, n73 INT DEFAULT NULL, n74 FLOAT DEFAULT NULL, n75 FLOAT DEFAULT NULL, n76 FLOAT DEFAULT NULL, n77 FLOAT DEFAULT NULL,
n78 FLOAT DEFAULT NULL, n79 FLOAT DEFAULT NULL, n80 FLOAT DEFAULT NULL, n81 FLOAT DEFAULT NULL, n82 FLOAT DEFAULT NULL, n83 FLOAT DEFAULT NULL, n84 FLOAT DEFAULT NULL,
n85 FLOAT DEFAULT NULL, n86 FLOAT DEFAULT NULL, n87 FLOAT DEFAULT NULL, n88 FLOAT DEFAULT NULL, n89 FLOAT DEFAULT NULL, n90 FLOAT DEFAULT NULL, n91 FLOAT DEFAULT NULL,
n92 FLOAT DEFAULT NULL, n93 FLOAT DEFAULT NULL, n94 FLOAT DEFAULT NULL, n95 INT DEFAULT NULL, n96 INT DEFAULT NULL, n97 INT DEFAULT NULL, n98 INT DEFAULT NULL,
n99 INT DEFAULT NULL, n100 INT DEFAULT NULL, n101 INT DEFAULT NULL, n102 TEXT DEFAULT NULL, n103 INT DEFAULT NULL, n104 TEXT DEFAULT NULL, n105 int DEFAULT NULL,
n106 TEXT DEFAULT NULL, n107 INT DEFAULT NULL, n108 TEXT DEFAULT NULL, n109 TEXT DEFAULT NULL, n110 INT DEFAULT NULL, n111 TEXT DEFAULT NULL, n112 TEXT DEFAULT NULL,
n113 FLOAT DEFAULT NULL, n114 FLOAT DEFAULT NULL, n115 FLOAT DEFAULT NULL, n116 FLOAT DEFAULT NULL, n117 CHAR(5) DEFAULT NULL, n118 CHAR(5) DEFAULT NULL);

\copy temp_import from fr-esr-parcoursup_MODIF.csv delimiter ';'

INSERT INTO import
SELECT
    CASE WHEN n1 ~ '^\d+$' THEN CAST(n1 AS INT) ELSE NULL END,
    n2,
    n3,
    n4,
    n5,
    n6,
    n7,
    n8,
    n9,
    n10,
    n11,
    n12,
    n13,
    n14,
    n15,
    n16,
    n17,
    CASE WHEN n18 ~ '^\d+$' THEN CAST(n18 AS INT) ELSE NULL END,
    CASE WHEN n19 ~ '^\d+$' THEN CAST(n19 AS INT) ELSE NULL END,
    CASE WHEN n20 ~ '^\d+$' THEN CAST(n20 AS INT) ELSE NULL END,
    CASE WHEN n21 ~ '^\d+$' THEN CAST(n21 AS INT) ELSE NULL END,
    CASE WHEN n22 ~ '^\d+$' THEN CAST(n22 AS INT) ELSE NULL END,
    CASE WHEN n23 ~ '^\d+$' THEN CAST(n23 AS INT) ELSE NULL END,
    CASE WHEN n24 ~ '^\d+$' THEN CAST(n24 AS INT) ELSE NULL END,
    CASE WHEN n25 ~ '^\d+$' THEN CAST(n25 AS INT) ELSE NULL END,
    CASE WHEN n26 ~ '^\d+$' THEN CAST(n26 AS INT) ELSE NULL END,
    CASE WHEN n27 ~ '^\d+$' THEN CAST(n27 AS INT) ELSE NULL END,
    CASE WHEN n28 ~ '^\d+$' THEN CAST(n28 AS INT) ELSE NULL END,
    CASE WHEN n29 ~ '^\d+$' THEN CAST(n29 AS INT) ELSE NULL END,
    CASE WHEN n30 ~ '^\d+$' THEN CAST(n30 AS INT) ELSE NULL END,
    CASE WHEN n31 ~ '^\d+$' THEN CAST(n31 AS INT) ELSE NULL END,
    CASE WHEN n32 ~ '^\d+$' THEN CAST(n32 AS INT) ELSE NULL END,
    CASE WHEN n33 ~ '^\d+$' THEN CAST(n33 AS INT) ELSE NULL END,
    CASE WHEN n34 ~ '^\d+$' THEN CAST(n34 AS INT) ELSE NULL END,
    CASE WHEN n35 ~ '^\d+$' THEN CAST(n35 AS INT) ELSE NULL END,
    CASE WHEN n36 ~ '^\d+$' THEN CAST(n36 AS INT) ELSE NULL END,
    CASE WHEN n37 ~ '^\d+$' THEN CAST(n37 AS INT) ELSE NULL END,
    CASE WHEN n38 ~ '^\d+$' THEN CAST(n38 AS INT) ELSE NULL END,
    CASE WHEN n39 ~ '^\d+$' THEN CAST(n39 AS INT) ELSE NULL END,
    CASE WHEN n40 ~ '^\d+$' THEN CAST(n40 AS INT) ELSE NULL END,
    CASE WHEN n41 ~ '^\d+$' THEN CAST(n41 AS INT) ELSE NULL END,
    CASE WHEN n42 ~ '^\d+$' THEN CAST(n42 AS INT) ELSE NULL END,
    CASE WHEN n43 ~ '^\d+$' THEN CAST(n43 AS INT) ELSE NULL END,
    CASE WHEN n44 ~ '^\d+$' THEN CAST(n44 AS INT) ELSE NULL END,
    CASE WHEN n45 ~ '^\d+$' THEN CAST(n45 AS INT) ELSE NULL END,
    CASE WHEN n46 ~ '^\d+$' THEN CAST(n46 AS INT) ELSE NULL END,
    CASE WHEN n47 ~ '^\d+$' THEN CAST(n47 AS INT) ELSE NULL END,
    CASE WHEN n48 ~ '^\d+$' THEN CAST(n48 AS INT) ELSE NULL END,
    CASE WHEN n49 ~ '^\d+$' THEN CAST(n49 AS INT) ELSE NULL END,
    CASE WHEN n50 ~ '^\d+$' THEN CAST(n50 AS INT) ELSE NULL END,
    CASE WHEN n51 ~ '^-?\d+(\.\d+)?$' THEN CAST(CAST(n51 AS FLOAT) AS INT) ELSE NULL END,
    CASE WHEN n52 ~ '^-?\d+(\.\d+)?$' THEN CAST(CAST(n52 AS FLOAT) AS INT) ELSE NULL END,
    CASE WHEN n53 ~ '^\d+$' THEN CAST(n53 AS INT) ELSE NULL END,
    CASE WHEN n54 ~ '^\d+$' THEN CAST(n54 AS INT) ELSE NULL END,
    CASE WHEN n55 ~ '^\d+$' THEN CAST(n55 AS INT) ELSE NULL END,
    CASE WHEN n56 ~ '^\d+$' THEN CAST(n56 AS INT) ELSE NULL END,
    CASE WHEN n57 ~ '^\d+$' THEN CAST(n57 AS INT) ELSE NULL END,
    CASE WHEN n58 ~ '^\d+$' THEN CAST(n58 AS INT) ELSE NULL END,
    CASE WHEN n59 ~ '^\d+$' THEN CAST(n59 AS INT) ELSE NULL END,
    CASE WHEN n60 ~ '^\d+$' THEN CAST(n60 AS INT) ELSE NULL END,
    CASE WHEN n61 ~ '^\d+$' THEN CAST(n61 AS INT) ELSE NULL END,
    CASE WHEN n62 ~ '^\d+$' THEN CAST(n62 AS INT) ELSE NULL END,
    CASE WHEN n63 ~ '^\d+$' THEN CAST(n63 AS INT) ELSE NULL END,
    CASE WHEN n64 ~ '^\d+$' THEN CAST(n64 AS INT) ELSE NULL END,
    CASE WHEN n65 ~ '^\d+$' THEN CAST(n65 AS INT) ELSE NULL END,
    CASE WHEN n66 ~ '^\d+$' THEN CAST(n66 AS INT) ELSE NULL END,
    CASE WHEN n67 ~ '^\d+$' THEN CAST(n67 AS INT) ELSE NULL END,
    CASE WHEN n68 ~ '^\d+$' THEN CAST(n68 AS INT) ELSE NULL END,
    CASE WHEN n69 ~ '^\d+$' THEN CAST(n69 AS INT) ELSE NULL END,
    CASE WHEN n70 ~ '^\d+$' THEN CAST(n70 AS INT) ELSE NULL END,
    CASE WHEN n71 ~ '^\d+$' THEN CAST(n71 AS INT) ELSE NULL END,
    CASE WHEN n72 ~ '^\d+$' THEN CAST(n72 AS INT) ELSE NULL END,
    CASE WHEN n73 ~ '^\d+$' THEN CAST(n73 AS INT) ELSE NULL END,
    CASE WHEN n74 ~ '^-?\d+(\.\d+)?$' THEN CAST(n74 AS FLOAT) ELSE NULL END,
    CASE WHEN n75 ~ '^-?\d+(\.\d+)?$' THEN CAST(n75 AS FLOAT) ELSE NULL END,
    CASE WHEN n76 ~ '^-?\d+(\.\d+)?$' THEN CAST(n76 AS FLOAT) ELSE NULL END,
    CASE WHEN n77 ~ '^-?\d+(\.\d+)?$' THEN CAST(n77 AS FLOAT) ELSE NULL END,
    CASE WHEN n78 ~ '^-?\d+(\.\d+)?$' THEN CAST(n78 AS FLOAT) ELSE NULL END,
    CASE WHEN n79 ~ '^-?\d+(\.\d+)?$' THEN CAST(n79 AS FLOAT) ELSE NULL END,
    CASE WHEN n80 ~ '^-?\d+(\.\d+)?$' THEN CAST(n80 AS FLOAT) ELSE NULL END,
    CASE WHEN n81 ~ '^-?\d+(\.\d+)?$' THEN CAST(n81 AS FLOAT) ELSE NULL END,
    CASE WHEN n82 ~ '^-?\d+(\.\d+)?$' THEN CAST(n82 AS FLOAT) ELSE NULL END,
    CASE WHEN n83 ~ '^-?\d+(\.\d+)?$' THEN CAST(n83 AS FLOAT) ELSE NULL END,
    CASE WHEN n84 ~ '^-?\d+(\.\d+)?$' THEN CAST(n84 AS FLOAT) ELSE NULL END,
    CASE WHEN n85 ~ '^-?\d+(\.\d+)?$' THEN CAST(n85 AS FLOAT) ELSE NULL END,
    CASE WHEN n86 ~ '^-?\d+(\.\d+)?$' THEN CAST(n86 AS FLOAT) ELSE NULL END,
    CASE WHEN n87 ~ '^-?\d+(\.\d+)?$' THEN CAST(n87 AS FLOAT) ELSE NULL END,
    CASE WHEN n88 ~ '^-?\d+(\.\d+)?$' THEN CAST(n88 AS FLOAT) ELSE NULL END,
    CASE WHEN n89 ~ '^-?\d+(\.\d+)?$' THEN CAST(n89 AS FLOAT) ELSE NULL END,
    CASE WHEN n90 ~ '^-?\d+(\.\d+)?$' THEN CAST(n90 AS FLOAT) ELSE NULL END,
    CASE WHEN n91 ~ '^-?\d+(\.\d+)?$' THEN CAST(n91 AS FLOAT) ELSE NULL END,
    CASE WHEN n92 ~ '^-?\d+(\.\d+)?$' THEN CAST(n92 AS FLOAT) ELSE NULL END,
    CASE WHEN n93 ~ '^-?\d+(\.\d+)?$' THEN CAST(n93 AS FLOAT) ELSE NULL END,
    CASE WHEN n94 ~ '^-?\d+(\.\d+)?$' THEN CAST(n94 AS FLOAT) ELSE NULL END,
    CASE WHEN n95 ~ '^\d+$' THEN CAST(n95 AS INT) ELSE NULL END,
    CASE WHEN n96 ~ '^\d+$' THEN CAST(n96 AS INT) ELSE NULL END,
    CASE WHEN n97 ~ '^\d+$' THEN CAST(n97 AS INT) ELSE NULL END,
    CASE WHEN n98 ~ '^\d+$' THEN CAST(n98 AS INT) ELSE NULL END,
    CASE WHEN n99 ~ '^\d+$' THEN CAST(n99 AS INT) ELSE NULL END,
    CASE WHEN n100 ~ '^\d+$' THEN CAST(n100 AS INT) ELSE NULL END,
    CASE WHEN n101 ~ '^\d+$' THEN CAST(n101 AS INT) ELSE NULL END,
    n102,
    CASE WHEN n103 ~ '^\d+$' THEN CAST(n103 AS INT) ELSE NULL END,
    n104,
    CASE WHEN n105 ~ '^\d+$' THEN CAST(n105 AS INT) ELSE NULL END,
    n106,
    CASE WHEN n107 ~ '^\d+$' THEN CAST(n107 AS INT) ELSE NULL END,
    n108,
    n109,
    CASE WHEN n110 ~ '^\d+$' THEN CAST(n110 AS INT) ELSE NULL END,
    n111,
    n112,
    CASE WHEN n113 ~ '^-?\d+(\.\d+)?$' THEN CAST(n113 AS FLOAT) ELSE NULL END,
    CASE WHEN n114 ~ '^-?\d+(\.\d+)?$' THEN CAST(n114 AS FLOAT) ELSE NULL END,
    CASE WHEN n115 ~ '^-?\d+(\.\d+)?$' THEN CAST(n115 AS FLOAT) ELSE NULL END,
    CASE WHEN n116 ~ '^-?\d+(\.\d+)?$' THEN CAST(n116 AS FLOAT) ELSE NULL END,
    n117,
    n118
FROM temp_import;
DROP TABLE temp_import;